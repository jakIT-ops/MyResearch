# 1. Introduction to Markov Chains

### What are Markov chains?

A Markov chain is a stochastic process that models a finite set of states, with fixed conditional probabilities of transitioning, or moving, from one given state to another.

This means that our model will randomly jump around different states, with a certain probability of going from each state to another one. The model is incredibly easy to understand, and it follows the Markov property.

---------

Amazing! Now that you understand the basics of how Markov models work, we will see some of the applications of Markov models in NLP.

1. Text generation (we will be building this in the next part).

2. Financial modeling and forecasting (including trading algorithms).

3. Logistics: modeling future deliveries or trips.

4. Search engines: PageRank can be seen as modeling a random internet surfer with a Markov chain.

5. Lyrics generation

6. Programming language code generation Also, we can understand that Markov chains are being used to solve probabilistic reasoning problems.

# 2. Assignments

We ask that you take these tasks seriously as they will help you develop an in-depth understanding. We have three tasks for you:

* Build a model with K = 6, K = 8 and K = 10 and check the text generated.

* Take some other corpus of your own choice and generate the text.

* One interesting project is to generate lyrics of songs. Just take four to five of your favorite songs, train the Markov model and generate some new songs. This will be a fun project.

## Problem one

Build a model with `K = 6`, `K = 8` and `K = 10` and check the text generated.

We will use the same code and functions that we created in our previous lessons.

```py
import numpy as np

# Generate the Lookup Table
def generateTable(data,k):  
  T = {}
  for i in range(len(data)-k):
    X = data[i:i+k]
    Y = data[i+k]
    if T.get(X) is None:
      T[X] = {}
      T[X][Y] = 1
    else:
      if T[X].get(Y) is None:
        T[X][Y] = 1
      else:
        T[X][Y] += 1
  return T

# Convert the Frequencies into Probability
def convertFreqIntoProb(T):     
  for kx in T.keys():
    s = float(sum(T[kx].values()))
    for k in T[kx].keys():
      T[kx][k] = T[kx][k]/s          
  return T

# Load the training data
def load_text(filename):
  with open(filename,encoding='utf8') as f:
    return f.read().lower()

# Create the Markov Chains
def MarkovChain(text,k):
    T = generateTable(text,k)
    T = convertFreqIntoProb(T)
    return T

# Perform Sampling
def sample_next(ctx,model,k):
    ctx = ctx[-k:]
    if model.get(ctx) is None:
        return " "
    possible_Chars = list(model[ctx].keys())
    possible_values = list(model[ctx].values())
    return np.random.choice(possible_Chars,p=possible_values)

# Generate the Text
def generateText(starting_sent,k ,maxLen):
    model = MarkovChain(text, k)
    sentence = starting_sent
    ctx = starting_sent[-k:]
    for ix in range(maxLen):
        next_prediction = sample_next(ctx,model,k)
        sentence += next_prediction
        ctx = sentence[-k:]
    return sentence

text = load_text("train_corpus.txt")
generated_text = generateText("dear my countrymen",k=8,maxLen=2000)
print(generated_text)
```

`Explanation:`

* We created the all the functions that we discussed in the previous lessons. One thing that has been changed is the default value of K = 4 in every function. We removed this default value as for every different value of K, we need to generate a new Markov chain model.

* Run the above code with different values of K just by changing the value of K passed in the generateText() function.

## Problem two

Take some other corpus of your own choice and generate the text.

For this problem, we will use song lyrics. Below is a sample Indian song, which is in Hindi. You can take any other song lyrics of your choice.

```py
# Load the corpus
text = load_text("text_generation_assignment_song.txt")

# Cleaning the data a little bit
text = text.replace("\n"," ")

# Perform Text Generation
generated_text = generateText("apna time aaega apna",k=8,maxLen=2000)
print(generated_text)
```

`Explanation:`

* If you have taken any other file, then you just need to change the file loaded in the above load_text() function.

* On line 5, we performed some text cleaning for better building Markov models.

* On line 9, we got our song generated by our Markov model.
